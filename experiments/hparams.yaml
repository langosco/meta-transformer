name: depoisoning_sweep_for_mup
project: depoison-sweeps
program: ./depoison.py
method: random
description: "Find good hparams for mup"
metric:
    name: val/loss
    goal: minimize
parameters:
    lr:
        distribution: log_uniform_values
        min: 1e-6
        max: 1e0
    wd:
        distribution: log_uniform_values
        min: 1e-7
        max: 1e-3
    in_factor:
        distribution: log_uniform_values
        min: 1e-5
        max: 1e5
    out_factor:
        distribution: log_uniform_values
        min: 1e-5
        max: 1e5
    attn_factor:
        distribution: log_uniform_values
        min: 1e-5
        max: 1e5
    init_scale:
        distribution: log_uniform_values
        min: 1e-2
        max: 1e2
#    adam_b1:
#        distribution: log_uniform_values
#        min: 0.00001
#        max: 0.1
#    adam_b2:
#        distribution: log_uniform_values
#        min: 0.00001
#        max: 0.1
#    adam_eps:
#        distribution: log_uniform_values
#        min: 1e-10
#        max: 1e-3
    chunk_size:
        value: 1024
    d_model:
        value: 1024
    bs:
        value: 64
    use_embedding:
        value: True
    ndata:
        value: 23_710
    epochs:
        value: 15
    max_runtime:  # in minutes
        value: 10
    dataset:
        value: mnist
    log_interval:
        value: 5
    dropout:
        value: 0.05
    dataset:
        value: mnist
command:
    - python3
    - depoison.py
    - --use_wandb
    - ${args}
